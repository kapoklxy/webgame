<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘½è¿ç”»å»Š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .game-container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            transition: all 0.5s ease;
        }

        .game-container.fullscreen {
            max-width: 100%;
            height: 100vh;
            gap: 0;
        }

        /* æ¸¸æˆç”»æ¡†éƒ¨åˆ† */
        .game-frame {
            position: relative;
            width: 100%;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 3px solid #ffd700;
            transition: all 0.5s ease;
        }

        .game-frame.fullscreen {
            border-radius: 0;
            border: none;
            box-shadow: none;
            height: 100vh;
        }

        /* 16:9 æ¯”ä¾‹å®¹å™¨ */
        .game-frame::before {
            content: '';
            display: block;
            padding-top: 56.25%; /* 16:9 æ¯”ä¾‹ (9/16 = 0.5625) */
        }

        .game-frame.fullscreen::before {
            display: none;
        }

        .game-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            transition: all 0.5s ease;
        }

        .game-frame.fullscreen .game-content {
            position: relative;
        }

        /* æ¸¸æˆå†…å®¹åŒºåŸŸ */
        .story-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .story-image, .story-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .story-video {
            background: #000;
        }

        /* å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶çš„æ ·å¼ */
        .story-image.error {
            display: none;
        }

        /* æ—ç™½æ–‡å­—æ ·å¼ */
        .narration-text {
            position: absolute;
            top: 8%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.55);
            color: #fff;
            font-size: 1.6rem;
            font-weight: bold;
            padding: 0.5em 2em;
            border-radius: 0.3em;
            text-align: center;
            z-index: 15;
            pointer-events: none;
            letter-spacing: 0.05em;
            max-width: 80%;
            box-shadow: 0 2px 12px rgba(0,0,0,0.15);
            user-select: none;
        }

        /* è¿”å›æŒ‰é’®æ ·å¼ */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 1000;
            opacity: 0;
            transform: translateX(-50px);
            transition: all 0.3s ease;
            display: none;
        }

        .back-btn.show {
            opacity: 1;
            transform: translateX(0);
            display: block;
        }

        .back-btn:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        /* æ¨ªå±æç¤ºæ ·å¼ */
        .landscape-prompt {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            z-index: 9999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .landscape-prompt.show {
            display: flex;
        }

        .landscape-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: rotate 2s ease-in-out infinite;
        }

        @keyframes rotate {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(90deg); }
        }

        .landscape-text {
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .landscape-subtext {
            font-size: 1rem;
            opacity: 0.8;
        }

        .start-overlay {
            position: absolute;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            background: rgba(0,0,0,0.25);
            z-index: 20;
            transition: opacity 0.3s;
        }
        .start-overlay.hide {
            opacity: 0;
            pointer-events: none;
        }
        .start-btn {
            background: rgba(0,0,0,0.7);
            color: #fff;
            font-size: 2.2rem;
            border: none;
            border-radius: 0;
            padding: 0.6em 2em;
            cursor: pointer;
            box-shadow: none;
            outline: none;
            letter-spacing: 0.1em;
            font-family: inherit;
            font-weight: bold;
            transition: background 0.2s;
            margin-bottom: 8%;
        }
        .start-btn:active {
            background: rgba(0,0,0,0.9);
        }

        /* ç§»åŠ¨ç«¯æ¨ªå±æ ·å¼ */
        @media (max-width: 768px) and (orientation: landscape) {
            .game-container {
                max-width: 100%;
                gap: 15px;
            }
            
            .game-title h1 {
                font-size: 2rem;
                margin-bottom: 5px;
            }
            
            .game-title .subtitle {
                font-size: 0.9rem;
            }
            
            .story-area {
                padding: 20px;
            }
            
            .choices-area {
                padding: 15px 20px;
            }
            
            .choice-btn {
                padding: 10px 20px;
                font-size: 1rem;
                min-width: 150px;
            }
        }

        /* ç§»åŠ¨ç«¯ç«–å±æ ·å¼ */
        @media (max-width: 768px) and (orientation: portrait) {
            .game-title h1 {
                font-size: 2.5rem;
            }
            
            .choices-container {
                flex-direction: column;
                align-items: center;
            }
            
            .choice-btn {
                min-width: 250px;
            }
        }

        @media (max-width: 480px) {
            .game-title h1 {
                font-size: 2rem;
            }
            
            .story-area {
                padding: 20px;
            }
            
            .choices-area {
                padding: 20px;
            }
        }
        .branch-buttons {
            position: absolute;
            left: 50%;
            bottom: 8%;
            transform: translateX(-50%);
            display: flex;
            gap: 2.5em;
            z-index: 20;
        }
        .branch-btn {
            background: linear-gradient(90deg, #a80000 0%, #d32f2f 100%);
            opacity: 0.92;
            color: #fff;
            font-size: 1.3rem;
            border: none;
            border-radius: 0.5em;
            padding: 0.5em 2em;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            box-shadow: none;
            outline: none;
            letter-spacing: 0.05em;
            transition: background 0.2s, opacity 0.2s;
        }
        .branch-btn:active {
            opacity: 1;
            background: linear-gradient(90deg, #d32f2f 0%, #a80000 100%);
        }
        #videoControls {
            position: absolute;
            right: 2.5%;
            bottom: 3%;
            display: flex;
            gap: 0.5em;
            z-index: 50;
        }
        .vc-btn {
            background: rgba(0,0,0,0.7);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 2.5em;
            height: 2.5em;
            font-size: 1.2em;
            cursor: pointer;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        .vc-btn:active {
            background: rgba(0,0,0,0.95);
        }
    </style>
</head>
<body>
    <!-- æ¨ªå±æç¤º -->
    <div class="landscape-prompt" id="landscapePrompt">
        <div class="landscape-icon">ğŸ“±</div>
        <div class="landscape-text">è¯·æ—‹è½¬è®¾å¤‡è‡³æ¨ªå±æ¨¡å¼</div>
        <div class="landscape-subtext">ä¸ºäº†è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒ</div>
    </div>

    <!-- è¿”å›æŒ‰é’® -->
    <button class="back-btn" id="backBtn">â† è¿”å›</button>

    <div class="game-container">
        <!-- æ¸¸æˆç”»æ¡†éƒ¨åˆ† -->
        <div class="game-frame">
            <div class="game-content">
                <!-- æ•…äº‹å†…å®¹åŒºåŸŸ -->
                <div class="story-area">
                    <img src="images/1.png" alt="æ¸¸æˆåœºæ™¯" class="story-image" id="storyImage" style="display:block;">
                    <div class="start-overlay" id="startOverlay" style="z-index:30;">
                        <button class="start-btn" id="startBtn">ç‚¹å‡»å¼€å§‹</button>
                    </div>
                    <video class="story-video" id="storyVideo" style="display:none;" playsinline></video>
                    <div class="narration-text" id="narrationText" style="display:none;"></div>
                    <div class="branch-buttons" id="branchButtons" style="display:none;"></div>
                    <div id="videoControls" style="display:none;">
                        <button class="vc-btn" id="vcPlayPause">â¯</button>
                        <button class="vc-btn" id="vcRewind">âª</button>
                        <button class="vc-btn" id="vcForward">â©</button>
                        <button class="vc-btn" id="vcSpeed">1.5x</button>
                    </div>
                </div>

                <!-- é€‰æ‹©æŒ‰é’®åŒºåŸŸ -->
                
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ç®¡ç†
        let gameStarted = false;
        let isMobile = false;
        let currentNode = 'start';
        let currentImageIndex = 0;
        let imageSwitchInterval = null;

        // å‰§æƒ…èŠ‚ç‚¹æ•°æ®ç»“æ„
        const storyNodes = {
            'start': {
                media: [
                { type: 'video', src: 'images/è§†é¢‘1.mp4', text: '' }
                ],
                nextNode: 'prologue0',
                choices: null
            },
            'prologue0': {
                media: [
                    { type: 'image', src: 'images/3.png', text: '' },
                    { type: 'video', src: 'images/è§†é¢‘1.1.mp4', text: '' }

                ],
                nextNode:'prologue',
                choices: null
            },
            'prologue': {
                media: [

                    { type: 'image', src: 'images/4.png', text: 'è¯·é€‰æ‹©è¦ç©¿è¶Šçš„ç¬é—´ï¼ˆç¼–å·ä»å·¦å¾€å³ï¼‰' }
                ],
                nextNode:null,
                choices: [
                    { text: 'ç”»å¹…ä¸€', next: 'chapter1' },
                    { text: 'ç”»å¹…äºŒ', next: 'chapter2' },
                    { text: 'ç”»å¹…ä¸‰', next: 'chapter3' },
                    { text: 'ç”»å¹…å››', next: 'chapter4' },
                    { text: 'ç”»å¹…äº”', next: 'chapter5' }
                ]
            },
            'chapter1': {
                media: [
                { type: 'video', src: 'images/è§†é¢‘1.2.1.mp4', text: '' },
                { type: 'image', src: 'images/5.png', text: 'ä½ å°†ç©¿è¶Šåˆ°è¿™ä¸ªæ—¶åˆ»' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°é€‰æ‹©', next: 'prologue' }
                ]
            },
            'chapter2': {
                media: [
                    { type: 'video', src: 'images/è§†é¢‘1.2.2.mp4', text: '' },
                    { type: 'image', src: 'images/6.png', text: 'ä½ å°†ç©¿è¶Šåˆ°è¿™ä¸ªæ—¶åˆ»' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°é€‰æ‹©', next: 'prologue' }
                ]
            },
            'chapter3': {
                media: [
                    { type: 'video', src: 'images/è§†é¢‘1.2.3.mp4', text: '' },
                    { type: 'image', src: 'images/7.png', text: 'ä½ å°†ç©¿è¶Šåˆ°è¿™ä¸ªæ—¶åˆ»' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°é€‰æ‹©', next: 'prologue' }
                ]
            },
            'chapter4': {
                media: [
                    { type: 'video', src: 'images/è§†é¢‘1.2.4.mp4', text: '' },
                    { type: 'image', src: 'images/8.png', text: 'ä½ å°†ç©¿è¶Šåˆ°è¿™ä¸ªæ—¶åˆ»' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°é€‰æ‹©', next: 'prologue' }
                ]
            },
            'chapter5': {
                media: [
                    { type: 'video', src: 'images/è§†é¢‘1.2.5.mp4', text: '' },
                    { type: 'image', src: 'images/9.png', text: 'ä½ å°†ç©¿è¶Šåˆ°è¿™ä¸ªæ—¶åˆ»' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°é€‰æ‹©', next: 'prologue' }
                ]
            },
            'TBC': {
                media: [
                    { type: 'image', src: 'images/1.png', text: 'æœªå®Œå¾…ç»­' }
                ],
                nextNode: null,
                choices: [
                    { text: 'æœªå®Œå¾…ç»­', next: 'TBC' },
                    { text: 'é‡æ–°å¼€å§‹', next: 'prologue' }
                ]
            }
        };

        // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
        function detectMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // æ£€æµ‹å±å¹•æ–¹å‘
        function getOrientation() {
            return window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
        }

        // æ˜¾ç¤º/éšè—æ¨ªå±æç¤º
        function toggleLandscapePrompt() {
            const prompt = document.getElementById('landscapePrompt');
            const isPortrait = getOrientation() === 'portrait';
            
            if (isMobile && gameStarted && isPortrait) {
                prompt.classList.add('show');
            } else {
                prompt.classList.remove('show');
            }
        }

        // åˆå§‹åŒ–
        function init() {
            isMobile = detectMobile();
            console.log('æ¸¸æˆç•Œé¢å·²åŠ è½½');
            console.log('è®¾å¤‡ç±»å‹:', isMobile ? 'ç§»åŠ¨ç«¯' : 'æ¡Œé¢ç«¯');
            console.log('å½“å‰æ–¹å‘:', getOrientation());

            // ç›‘å¬å±å¹•æ–¹å‘å˜åŒ–
            window.addEventListener('orientationchange', function() {
                setTimeout(toggleLandscapePrompt, 100);
            });

            // ç›‘å¬çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', function() {
                toggleLandscapePrompt();
            });

            // æ·»åŠ è¿”å›æŒ‰é’®äº‹ä»¶
            const backBtn = document.getElementById('backBtn');
            if (backBtn) {
                backBtn.addEventListener('click', exitFullscreen);
            }
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            gameStarted = true;
            loadCurrentNode();
        }

        // å¼€å§‹å‰§æƒ…
        function startStory() {
            console.log('å¼€å§‹å‰§æƒ…');
            currentNode = 'start';
            currentImageIndex = 0;
            loadCurrentNode();
        }

        // æ¸²æŸ“åˆ†æ”¯æŒ‰é’®
        function renderBranchButtons(choices) {
            const branchButtons = document.getElementById('branchButtons');
            branchButtons.innerHTML = '';
            if (!choices || !Array.isArray(choices) || choices.length === 0) {
                branchButtons.style.display = 'none';
                return;
            }
            choices.forEach((choice, idx) => {
                const btn = document.createElement('button');
                btn.className = 'branch-btn';
                btn.textContent = choice.text;
                btn.onclick = function() {
                    currentNode = choice.next;
                    loadCurrentNode();
                };
                branchButtons.appendChild(btn);
            });
            branchButtons.style.display = 'flex';
        }

        // åŠ è½½å½“å‰èŠ‚ç‚¹
        function loadCurrentNode() {
            const node = storyNodes[currentNode];
            const branchButtons = document.getElementById('branchButtons');
            if (!node) {
                console.log('å‰§æƒ…ç»“æŸ');
                return;
            }
            // åˆ†æ”¯æŒ‰é’®å…ˆéšè—å¹¶æ¸…ç©º
            if (branchButtons) {
                branchButtons.style.display = 'none';
                branchButtons.innerHTML = '';
            }

            // åœæ­¢ä¹‹å‰çš„åª’ä½“åˆ‡æ¢
            if (imageSwitchInterval) {
                clearTimeout(imageSwitchInterval);
            }

            // æ˜¾ç¤ºç¬¬ä¸€ä¸ªåª’ä½“å’Œæ—ç™½
            currentImageIndex = 0;
            showMedia(node.media[0]);

            // è‡ªåŠ¨åˆ‡æ¢åª’ä½“é€»è¾‘
            if (node.media.length > 1) {
                if (node.choices && node.choices.length > 0) {
                    startMediaSwitchWithChoices(node.media, node.choices);
                } else {
                    startMediaSwitch(node.media);
                }
            } else {
                // å•ä¸ªåª’ä½“
                if (node.choices && node.choices.length > 0) {
                    // ç«‹å³æ˜¾ç¤ºåˆ†æ”¯æŒ‰é’®
                    renderBranchButtons(node.choices);
                } else if (node.nextNode) {
                    imageSwitchInterval = setTimeout(() => {
                        nextNode();
                    }, 3000);
                }
            }
        }

        // å¤šåª’ä½“èŠ‚ç‚¹ä¸”æœ‰choicesï¼Œå…¨éƒ¨æ˜¾ç¤ºå®Œåå†æ˜¾ç¤ºåˆ†æ”¯æŒ‰é’®
        function startMediaSwitchWithChoices(mediaArr, choices) {
            let index = 0;
            function showNext() {
                index++;
                if (index < mediaArr.length) {
                    showMedia(mediaArr[index]);
                    if (mediaArr[index].type === 'video') {
                        const storyVideo = document.getElementById('storyVideo');
                        if (storyVideo) {
                            storyVideo.onended = function() {
                                showNext();
                            };
                        }
                    } else {
                        imageSwitchInterval = setTimeout(showNext, 3000);
                    }
                } else {
                    // åœç•™åœ¨æœ€åä¸€ä¸ªï¼Œç«‹å³æ˜¾ç¤ºåˆ†æ”¯æŒ‰é’®
                    renderBranchButtons(choices);
                }
            }
            // é¦–ä¸ªåª’ä½“
            showMedia(mediaArr[0]);
            if (mediaArr[0].type === 'video') {
                const storyVideo = document.getElementById('storyVideo');
                if (storyVideo) {
                    storyVideo.onended = function() {
                        showNext();
                    };
                }
            } else {
                imageSwitchInterval = setTimeout(showNext, 3000);
            }
        }
        // å¤šåª’ä½“èŠ‚ç‚¹æ— choices
        function startMediaSwitch(mediaArr) {
            let index = 0;
            function showNext() {
                index++;
                if (index < mediaArr.length) {
                    showMedia(mediaArr[index]);
                    if (mediaArr[index].type === 'video') {
                        const storyVideo = document.getElementById('storyVideo');
                        if (storyVideo) {
                            storyVideo.onended = function() {
                                showNext();
                            };
                        }
                    } else {
                        imageSwitchInterval = setTimeout(showNext, 3000);
                    }
                } else {
                    // æ‰€æœ‰åª’ä½“æ˜¾ç¤ºå®Œæ¯•ï¼Œ3ç§’åè¿›å…¥ä¸‹ä¸€èŠ‚ç‚¹
                    imageSwitchInterval = setTimeout(() => {
                        nextNode();
                    }, 3000);
                }
            }
            // é¦–ä¸ªåª’ä½“
            showMedia(mediaArr[0]);
            if (mediaArr[0].type === 'video') {
                const storyVideo = document.getElementById('storyVideo');
                if (storyVideo) {
                    storyVideo.onended = function() {
                        showNext();
                    };
                }
            } else {
                imageSwitchInterval = setTimeout(showNext, 3000);
            }
        }

        // æ˜¾ç¤ºåª’ä½“å’Œæ—ç™½
        function showMedia(mediaObj) {
            const storyImage = document.getElementById('storyImage');
            const storyVideo = document.getElementById('storyVideo');
            const narrationText = document.getElementById('narrationText');
            const videoControls = document.getElementById('videoControls');
            if (mediaObj.type === 'image') {
                if (storyImage) {
                    storyImage.src = mediaObj.src;
                    storyImage.style.display = 'block';
                }
                if (storyVideo) {
                    storyVideo.pause();
                    storyVideo.style.display = 'none';
                }
                if (videoControls) videoControls.style.display = 'none';
            } else if (mediaObj.type === 'video') {
                if (storyImage) {
                    storyImage.style.display = 'none';
                }
                if (storyVideo) {
                    storyVideo.src = mediaObj.src;
                    storyVideo.style.display = 'block';
                    storyVideo.muted = false;
                    storyVideo.autoplay = true;
                    storyVideo.controls = false;
                    storyVideo.currentTime = 0;
                    storyVideo.play();
                }
                if (videoControls) videoControls.style.display = 'flex';
            }
            if (narrationText) {
                if (mediaObj.text && mediaObj.text.trim() !== '') {
                    narrationText.textContent = mediaObj.text;
                    narrationText.style.display = 'block';
                } else {
                    narrationText.style.display = 'none';
                }
            }
        }

        // è¿›å…¥ä¸‹ä¸€èŠ‚ç‚¹
        function nextNode() {
            const node = storyNodes[currentNode];
            if (node && node.nextNode) {
                currentNode = node.nextNode;
                loadCurrentNode();
            } else {
                console.log('å‰§æƒ…ç»“æŸ');
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ç»“æŸé€»è¾‘
            }
        }

        // é€€å‡ºå…¨å±
        function exitFullscreen() {
            const gameContainer = document.querySelector('.game-container');
            const gameFrame = document.querySelector('.game-frame');
            const backBtn = document.getElementById('backBtn');
            
            // åœæ­¢å›¾ç‰‡åˆ‡æ¢
            if (imageSwitchInterval) {
                clearInterval(imageSwitchInterval);
                imageSwitchInterval = null;
            }
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            currentNode = 'start';
            currentImageIndex = 0;
            
            // ç§»é™¤å…¨å±ç±»
            gameContainer.classList.remove('fullscreen');
            gameFrame.classList.remove('fullscreen');
            backBtn.classList.remove('show');
            
            gameStarted = false;
            console.log('é€€å‡ºå…¨å±æ¨¡å¼');
        }

        // å¤„ç†å›¾ç‰‡åŠ è½½
        function handleImageLoad() {
            const storyImage = document.getElementById('storyImage');
            if (storyImage) {
                storyImage.addEventListener('load', function() {
                    console.log('é»˜è®¤å›¾ç‰‡åŠ è½½æˆåŠŸ');
                });
                
                storyImage.addEventListener('error', function() {
                    console.log('é»˜è®¤å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œéšè—å›¾ç‰‡');
                    this.classList.add('error');
                });
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            init();
            handleImageLoad();
            // å åŠ "ç‚¹å‡»å¼€å§‹"æŒ‰é’®é€»è¾‘
            const startOverlay = document.getElementById('startOverlay');
            const startBtn = document.getElementById('startBtn');
            if (startBtn && startOverlay) {
                startBtn.addEventListener('click', function() {
                    startOverlay.classList.add('hide');
                    gameStarted = true;
                    startGame();
                });
            }
            // è§†é¢‘æ§åˆ¶æŒ‰é’®äº‹ä»¶
            const storyVideo = document.getElementById('storyVideo');
            const vcPlayPause = document.getElementById('vcPlayPause');
            const vcRewind = document.getElementById('vcRewind');
            const vcForward = document.getElementById('vcForward');
            const vcSpeed = document.getElementById('vcSpeed');
            if (vcPlayPause && storyVideo) {
                vcPlayPause.addEventListener('click', function() {
                    if (storyVideo.paused) {
                        storyVideo.play();
                    } else {
                        storyVideo.pause();
                    }
                });
            }
            if (vcRewind && storyVideo) {
                vcRewind.addEventListener('click', function() {
                    storyVideo.currentTime = Math.max(0, storyVideo.currentTime - 5);
                });
            }
            if (vcForward && storyVideo) {
                vcForward.addEventListener('click', function() {
                    storyVideo.currentTime = Math.min(storyVideo.duration, storyVideo.currentTime + 5);
                });
            }
            if (vcSpeed && storyVideo) {
                vcSpeed.addEventListener('click', function() {
                    if (storyVideo.playbackRate === 1.5) {
                        storyVideo.playbackRate = 1.0;
                        vcSpeed.textContent = '1x';
                    } else {
                        storyVideo.playbackRate = 1.5;
                        vcSpeed.textContent = '1.5x';
                    }
                });
            }
        });
    </script>
</body>
</html> 